# Функции даты и времени Часть 4

# Форматирование

**По умолчанию вывод даты и времени осуществляется в ISO формате (2023-10-15, год-месяц-день).**

SQL позволяет определить любой необходимый формат отображение даты и времени с помощью **строк формата.** 
Например дата `2023-10-15` при форматировании в соответствии со строкой формата `%d.%m.%Y` будет иметь вид `25.10.2023`. Значения `%d, %m` и `%Y` в строке формата называются **спецификаторами формата.**

Таблица основных спецификаторов формата:

| **Спецификатор** | **Описание**                   |
|------------------|--------------------------------|
| `%M`             | Полное название месяца         |    
| `%b`             | Сокращение название месяца     |
| `%W`             | Полное название дня недели     |
| `%a`             | Сокращение названия дня недели |
| `%Y`             | Год                            |
| `%m`             | Номер месяца                   |
| `%d`             | День месяца                    |
| `%w`             | Номер дня недели               |
| `%H`             | Часы                           |
| `%i`             | Минуты                         |
| `%S`             | Секунд                         |
| `%f`             | Микросекунды                   |
| `%T`             | Время в формате `HH.MM.SS`     |


# Функция DATE_FORMAT()

Функция `DATE_FORMAT()` используется для форматирования даты и времени. Принимает в качестве аргумента значения в следующем порядке:

* `datetime` - время и дата
* `format` - строка формата

Функция преобразует `datetime` в заданный `format`.

Результатом запроса:

```
SELECT DATE_FORMAT('2023-10-20 07:30:00', '%H:%i, %d.%m.%Y');
```

будет:

```
+-------------------------------------------------------+
| DATE_FORMAT('2023-10-20 07:30:00', '%H:%i, %d.%m.%Y') |
+-------------------------------------------------------+
| 07:30, 20.10.2023                                     |
+-------------------------------------------------------+
```

Функция `DATE_FORMAT()` в качестве аргумента может принимать не только дату и время, но и просто дату. Во втором случае считается, что дата имеет нулевые значения по всем компонентам времени.

Результатом запроса:

```
SELECT DATE_FORMAT('2023-10-20', '%d.%m.%Y'),
       DATE_FORMAT('2023-10-20', '%H:%i, %d.%m.%Y');
```

будет:

```
+---------------------------------------+----------------------------------------------+
| DATE_FORMAT('2023-10-20', '%d.%m.%Y') | DATE_FORMAT('2023-10-20', '%H:%i, %d.%m.%Y') |
+---------------------------------------+----------------------------------------------+
| 20.10.2023                            | 00:00, 20.10.2023                            |
+---------------------------------------+----------------------------------------------+
```

# Функция TIME_FORMAT()

Функция `TIME_FORMAT()` используется для форматирования времени и принимает два аргумента в следующем порядке:

* `time` - временное значение
* `format` - строка формата

Аналогично фунции `DATE_FORMAT()` преобразует значение в соответствии с заданным форматом, только в контексте времени.

Результатом запроса:

```
SELECT TIME_FORMAT('12:30:00', '%H::%i::%s'),
       TIME_FORMAT('12:30:00', 'Time: %H:%i');
```

будет:

```
+---------------------------------------+----------------------------------------+
| TIME_FORMAT('12:30:00', '%H::%i::%s') | TIME_FORMAT('12:30:00', 'Time: %H:%i') |
+---------------------------------------+----------------------------------------+
| 12::30::00                            | Time: 12:30                            |
+---------------------------------------+----------------------------------------+
```

# Функция STR_TO_DATE()

Функция `STR_TO_DATE()` используется для выполнения операции, обратной форматированию. Принимает два аргумента в следующем порядке:

* `string` - строка с компонентами даты и времени
* `format` - строка формата

Функция извлекает из строки `string` компоненты даты и времени в соответствии с форматом `format` и возвращает дату и время на основе извлеченных компонентов.

Результатом запроса:

```
SELECT STR_TO_DATE('07:30, 20.10.2023', '%H:%i, %d.%m.%Y');
```

будет:

```
+-----------------------------------------------------+
| STR_TO_DATE('07:30, 20.10.2023', '%H:%i, %d.%m.%Y') |
+-----------------------------------------------------+
| 2023-10-20 07:30:00                                 |
+-----------------------------------------------------+
```

Если в строке с компонентами представлены только компоненты даты, функция `STR_TO_DATE()` вернет дату без времени, если только компоненты времени - время без даты.

Результатом запроса:

```
SELECT STR_TO_DATE('20.10.2023', '%d.%m.%Y'),
       STR_TO_DATE('Time: 07:30', 'Time: %H:%i');
```

будет:

```
+---------------------------------------+-------------------------------------------+
| STR_TO_DATE('20.10.2023', '%d.%m.%Y') | STR_TO_DATE('Time: 07:30', 'Time: %H:%i') |
+---------------------------------------+-------------------------------------------+
| 2023-10-20                            | 07:30:00                                  |
+---------------------------------------+-------------------------------------------+
```

Если хотя бы один компонент будет пропущен при вызове функции, она вернет значение `NULL`. В случае со временем достаточно хотя бы одного временного компонента, все остальные по умолчанию примут значение `0`.

Результатом запроса:

```
SELECT STR_TO_DATE('20.10', '%d.%m'),
       STR_TO_DATE('Time: 07', 'Time: %H');
```

будет:

```
+-------------------------------+-------------------------------------+
| STR_TO_DATE('20.10', '%d.%m') | STR_TO_DATE('Time: 07', 'Time: %H') |
+-------------------------------+-------------------------------------+
| NULL                          | 7:00:00                             |
+-------------------------------+-------------------------------------+
```

Во время использования функции `STR_TO_DATE()` необходимо следить за тем, чтобы строка с компонентами даты и времени полностью соотвтествовала строке формата, в противном случае функция вернет значение `NULL`.

Результатом запроса:

```
SELECT STR_TO_DATE('20.10.2023', '%d-%m-%Y'),
       STR_TO_DATE('Time: 07:30', '%H:%i');
```

будет:

```
+---------------------------------------+-------------------------------------+
| STR_TO_DATE('20.10.2023', '%d-%m-%Y') | STR_TO_DATE('Time: 07:30', '%H:%i') |
+---------------------------------------+-------------------------------------+
| NULL                                  | NULL                                |
+---------------------------------------+-------------------------------------+
```

# Функция GET_FORMAT()

Функция `GET_FORMAT()` используется для получения определенной строки формата для даты, времени или даты и времени. Принимает два аргумента в следующем порядке:

* `type` - тип объекта, для которого требуется строка формата (`DATE, TIME` или `DATETIME`)
* `format` - непосредственный формат (`USA, JIS, ISO` или `EUR`)

Функция возвращает строку формата `format` для объекта типа `type`.

Результатом запроса:

```
SELECT GET_FORMAT(DATE, 'EUR'),
       GET_FORMAT(TIME, 'EUR'),
       GET_FORMAT(DATETIME, 'EUR');
```

будет:

```
+-------------------------+-------------------------+-----------------------------+
| GET_FORMAT(DATE, 'EUR') | GET_FORMAT(TIME, 'EUR') | GET_FORMAT(DATETIME, 'EUR') |
+-------------------------+-------------------------+-----------------------------+
| %d.%m.%Y                | %H.%i.%s                | %Y-%m-%d %H.%i.%s           |
+-------------------------+-------------------------+-----------------------------+
```

Функцию GET_FORMAT() удобно использовать совместно с функциями DATE_FORMAT() и TIME_FORMAT().

Результатом запроса:

```
SELECT DATE_FORMAT('2023-10-20', GET_FORMAT(DATE, 'USA')),
       TIME_FORMAT('07:30:00', GET_FORMAT(TIME, 'USA'));
```

будет:

```
+----------------------------------------------------+--------------------------------------------------+
| DATE_FORMAT('2023-10-20', GET_FORMAT(DATE, 'USA')) | TIME_FORMAT('07:30:00', GET_FORMAT(TIME, 'USA')) |
+----------------------------------------------------+--------------------------------------------------+
| 10.20.2023                                         | 07:30:00 AM                                      |
+----------------------------------------------------+--------------------------------------------------+
```
